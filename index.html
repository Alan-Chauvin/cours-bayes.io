<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="cours_2024_files/libs/clipboard/clipboard.min.js"></script>
<script src="cours_2024_files/libs/quarto-html/tabby.min.js"></script>
<script src="cours_2024_files/libs/quarto-html/popper.min.js"></script>
<script src="cours_2024_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="cours_2024_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cours_2024_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="cours_2024_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="cours_2024_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Thierry Phénix">
  <meta name="dcterms.date" content="2024-10-17">
  <title>Contexte pratique à la statistique bayésienne</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="cours_2024_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="cours_2024_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="cours_2024_files/libs/revealjs/dist/theme/quarto.css">
  <link href="cours_2024_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="cours_2024_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="cours_2024_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="cours_2024_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Contexte pratique à la statistique bayésienne</h1>
  <p class="subtitle">Applications en python</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Thierry Phénix 
</div>
<div class="quarto-title-author-email">
<a href="mailto:thierry-phenix@imad-ge.ch">thierry-phenix@imad-ge.ch</a>
</div>
        <p class="quarto-title-affiliation">
            IMAD – Institution genevoise de maintien à domicile, Genève Suisse
          </p>
    </div>
</div>

  <p class="date">October 17, 2024</p>
</section>
<section id="préambule" class="slide level2">
<h2>Préambule</h2>
<h4 id="objectifs-du-cours">Objectifs du cours</h4>
<div>
<ul>
<li class="fragment">Vous présenter les concepts de l’analyse Bayésienne</li>
<li class="fragment">Vous aider à comprendre la différence avec l’inférence fréquentiste</li>
<li class="fragment">vous convaincre que l’approche bayésienne est plus pertinente</li>
<li class="fragment">Vous donner les points d’entrée pour vous y mettre !<br>
</li>
</ul>
</div>
</section>
<section id="préambule-1" class="slide level2">
<h2>Préambule</h2>
<h4 id="objectifs-du-cours-1">Objectifs du cours</h4>
<ul>
<li>Vous présenter les concepts de l’analyse Bayésienne</li>
<li>Vous aider à comprendre la différence avec l’inférence fréquentiste</li>
<li>vous convaincre que l’approche bayésienne est plus pertinente</li>
<li>Vous donner les points d’entrée pour vous y mettre !</li>
</ul>
<h4 id="informations-pratiques">Informations pratiques</h4>
<div>
<ul>
<li class="fragment"><p>Ce cours se veut interactif. On ne se verra qu’une fois donc… n’hésitez pas à poser des questions !</p></li>
<li class="fragment"><p>Ce cours et ses sources seront disponibles en ligne à l’adresse suivante :</p>
<p><font size="4"><a href="https://miashs-www.u-ga.fr/prevert/SpecialiteSC/Cours/Methode_Experimentale_Neuroscience.html" class="uri">https://miashs-www.u-ga.fr/prevert/SpecialiteSC/Cours/Methode_Experimentale_Neuroscience.html</a></font></p></li>
</ul>
</div>
</section>
<section id="plan-du-cours" class="slide level2">
<h2>Plan du cours</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><strong>Contexte</strong></li>
<li>L’inférence bayésienne</li>
<li>Cas pratiques</li>
<li>Pour aller plus loin</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Définition</li>
<li>Fisher : Test de significativité</li>
<li>Neyman et Pearson : Test d’hypothèse</li>
<li>Inférence frequentiste aujourd’hui</li>
<li>Jeyffreys : Une alternative oubliée au test de significativté</li>
<li>Conclusion</li>
</ul>
</div></div>
</section>
<section id="contexte" class="slide level2">
<h2>Contexte</h2>
<h3 id="définition">Définition</h3>
<p><em>La statistique est la discipline qui étudie des phénomènes à travers la <strong>collecte de données</strong>, leur <strong>traitement</strong>, leur <strong>analyse</strong>, l’<strong>interprétation des résultats</strong> et leur présentation afin de rendre ces données compréhensibles par tous</em>. (wikipedia)</p>
</section>
<section id="contexte-1" class="slide level2">
<h2>Contexte</h2>
<h3 id="définition-1">Définition</h3>
<p><em>La statistique est la discipline qui étudie des phénomènes à travers la <strong>collecte de données</strong>, leur <strong>traitement</strong>, leur <strong>analyse</strong>, l’<strong>interprétation des résultats</strong> et leur présentation afin de rendre ces données compréhensibles par tous</em>. (wikipedia)</p>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<center>
<font color="orange"><b><strong>Statistiques descriptives</strong></b></font>
</center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/eda.jpeg" style="width:50.0%"></p>
<figcaption>On analyse un échantillon d’une population (moyenne, variance, outliers…)</figcaption>
</figure>
</div>
</div>
</div><div class="column" style="width:50%;">

</div></div>
</section>
<section id="contexte-2" class="slide level2">
<h2>Contexte</h2>
<h3 id="définition-2">Définition</h3>
<p><em>La statistique est la discipline qui étudie des phénomènes à travers la <strong>collecte de données</strong>, leur <strong>traitement</strong>, leur <strong>analyse</strong>, l’<strong>interprétation des résultats</strong> et leur présentation afin de rendre ces données compréhensibles par tous</em>. (wikipedia)</p>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<font color="orange"><b><strong>Statistiques descriptives</strong></b></font>
</center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/eda.jpeg" style="width:50.0%"></p>
<figcaption>On analyse un échantillon d’une population (moyenne, variance, outliers…)</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div>
<center>
<font color="orange"><b><strong>Statistiques inférentielles</strong></b></font>
</center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/inference.jpeg" style="width:60.0%"></p>
<figcaption>A partir d’un échantillon d’une population, on tire des conclusions sur cette population</figcaption>
</figure>
</div>
</div>
</div></div>
<!-- ## Contexte
### Définition
#### Un peu d'histoire

- XVIIe siècle : 
    - Blaise Pascal et Pierre de Fermat (entre autres) travaillent sur les problèmes de jeux de hasard.
    
- XVIIIe siècle : 
    - Thomas Bayes développe le théorème de Bayes, posant les bases de l'inférence bayésienne.

- XIXe siècle :
    - Pierre-Simon de Laplace et Carl Friedrich Gauss introduisent **la méthode des moindres carrés** et la **distribution normale**.
    - Francis Galton et Karl Pearson développent des méthodes de **corrélation** et de **régression** 
    - Karl Pearson introduit le test du chi-2 (premier test de significativité).

- XXe siècle :
    - Ronald Fisher formalise et généralise les tests de significativités 
    - Jerzy Neyman et Egon Pearson proposent des tests d'hypothèses, et d'intervalles de confiance
    - Harold Jeffreys développe des méthodes bayésiennes pratiques (Bayes Factor) -->
</section>
<section id="contexte-3" class="slide level2">
<h2>Contexte</h2>
<h3 id="fisher-test-de-significativité-1925-1935">Fisher : Test de significativité (1925-1935)</h3>
<div class="columns">
<div class="column" style="width:40%;">
<br>
<center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/person/ronaldfisher.jpg" style="width:50.0%"></p>
<figcaption>Sir Ronald Fisher (1890-1962)</figcaption>
</figure>
</div>
</center>
<p>Généticien et statisticien britannique unanimement reconnu pour avoir révolutionné la statistique.</p>
</div><div class="column" style="width:60%;">
<div>
<p><font color="orange"><b>Le but du test est de donnée une chance au données d’invalider une hypothèse.</b></font></p>
<ul>
<li class="fragment">Une seule hypothèse nommée hypothèse nulle (to be nullified) notée <span class="math inline">\(H_0\)</span></li>
<li class="fragment">On doit connaître la distribution d’échantillonnage sous l’hypothèse nulle <span class="math inline">\(P(_~|~H_0)\)</span> pour calculer la probabilité d’observer une valeur au moins aussi extrême que celle observée dans l’échantillon</li>
<li class="fragment">Si cette probabilité est faible, on rejette l’hypothèse nulle( seuil de significativité arbitraire)</li>
<li class="fragment">pas d’hypothèse alternative</li>
<li class="fragment">Il n’existe que l’erreur de type I, rejeter l’hypothèse nulle alors qu’elle est vraie</li>
</ul>
</div>
</div></div>
</section>
<section id="contexte-4" class="slide level2">
<h2>Contexte</h2>
<h3 id="neyman-et-pearson-test-dhypothèses-1928-1933">Neyman et Pearson : Test d’hypothèses (1928-1933)</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p><br></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/person/jerzyneynan.jpg" style="width:50.0%"></p>
<figcaption>Jerzy Neyman (1894-1981)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/person/egonpearson.jpg" style="width:62.0%"></p>
<figcaption>Egon Pearson (1895-1980)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p><strong>Jerzy Neyman</strong> mathématicien et statisticien d’origine polonaise.<br> <strong>Egon Pearson</strong> statisticien britanique</p>
</div><div class="column" style="width:60%;">
<div>
<p><font color="orange"><b>Ce test concerne la prise de décision rationnelle sur des hypothèses statistiques</b></font></p>
<ul>
<li class="fragment">Mise en avant de la nécessité d’une hypothèse alternative notée <span class="math inline">\(H_1\)</span> (complémentaires de <span class="math inline">\(H_0\)</span>)</li>
<li class="fragment">Le test définit une région de rejet et une région d’acceptation de <span class="math inline">\(H_0\)</span></li>
<li class="fragment">Le rôle du test est de minimiser sur le long terme la proportion de décisions erronées</li>
<li class="fragment">Il existe deux types d’erreurs :
<ul>
<li class="fragment">type I : rejeter <span class="math inline">\(H_0\)</span> alors qu’elle est vraie (noté <span class="math inline">\(\alpha\)</span>)</li>
<li class="fragment">type II : accepter <span class="math inline">\(H_0\)</span> alors qu’elle est fausse (noté <span class="math inline">\(\beta\)</span>)</li>
</ul></li>
<li class="fragment">La puissance d’une région est la probabilité de rejeter <span class="math inline">\(H_0\)</span> quand <span class="math inline">\(H_1\)</span> est vraie (égale à <span class="math inline">\(1-\beta\)</span>)</li>
</ul>
</div>
</div></div>
</section>
<section id="contexte-5" class="slide level2">
<h2>Contexte</h2>
<h3 id="inférence-fréquentiste-aujourdhui">Inférence fréquentiste aujourd’hui</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<font color="orange"><b>
</b></font><center><font color="orange"><b>
Une logique hybride</b></font>
</center>
<p>La norme en vigueur est un amalgame de différentes procédures plus ou moins compatibles :</p>
<ul>
<li class="fragment">La conception décisionnelle des tests d’hypothèse de Neyman et Pearson (Hypothèse alternative et puissance).</li>
<li class="fragment">La conception du test de significativité de Fisher (Hypothèse nulle et seuil de significativité)</li>
<li class="fragment">l’utilisation d’intervalles de confiance</li>
</ul>
</div>
</div><div class="column" style="width:50%;">

</div></div>
</section>
<section id="contexte-6" class="slide level2">
<h2>Contexte</h2>
<h3 id="inférence-fréquentiste-aujourdhui-1">Inférence fréquentiste aujourd’hui</h3>
<div class="columns">
<div class="column" style="width:50%;">
<font color="orange"><b>
</b></font><center><font color="orange"><b>
Une logique hybride</b></font>
</center>
<p>La norme en vigueur est un amalgame de différentes procédures plus ou moins compatibles :</p>
<ul>
<li>La conception décisionnelle des tests d’hypothèse de Neyman et Pearson (Hypothèse alternative et puissance).</li>
<li>La conception du test de significativité de Fisher (Hypothèse nulle et seuil de significativité)</li>
<li>l’utilisation d’intervalles de confiance</li>
</ul>
</div><div class="column" style="width:50%;">
<div>
<font color="orange"><b>
</b></font><center><font color="orange"><b>
Les faiblesses de l’approche</b></font>
</center>
<p>La p-value suscite de nombreuses critiques :</p>
<ul>
<li class="fragment">la valeur de seuil de significativité est arbitraire</li>
<li class="fragment">La p_value génère un biais de publication</li>
<li class="fragment">cette approche conduit toujours à une décision par la négative, l’hypothèse nulle est souvent la négation de l’hypothèse d’intérêt</li>
<li class="fragment">la p-value est sensible à la taille de l’échantillon (paradoxe de Lindley)</li>
<li class="fragment">Confusion entre significativité et taille d’effet : la p_value représente <span class="math inline">\(P(E|H_0)\)</span> et non <span class="math inline">\(P(H_0|E)\)</span></li>
</ul>
</div>
</div></div>
</section>
<section id="contexte-7" class="slide level2">
<h2>Contexte</h2>
<h3 id="jeyffreys-une-alternative-oubliée-au-test-de-significativté-1939">Jeyffreys : Une alternative “oubliée” au test de significativté (1939)</h3>
<div class="columns">
<div class="column" style="width:40%;">
<br>
<center>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/person/haroldjeffreys.jpg" style="width:50.0%"></p>
<figcaption>Sir Harold Jeffreys (1891-1989)</figcaption>
</figure>
</div>
</center>
<p>Géophysicien britannique <br> Considéré comme la première tentative de développer une théorie formelle de l’inférence statistique basée sur l’approche bayésienne</p>
</div><div class="column" style="width:60%;">
<div>
<p><font color="orange"><b>Ce test permet de compare deux hypothèses, une valeur précise d’un paramètre contre toutes les autres valeurs possibles</b></font></p>
<ul>
<li class="fragment">Il fait l’hypothèse que ces deux hypothèses sont équiprobables</li>
<li class="fragment">Il s’intéresse aux probabilités a posteriori <span class="math inline">\(P(H_0|E)\)</span> et <span class="math inline">\(P(H_1|E)\)</span> (E sont les observations)</li>
<li class="fragment">Et plus particulièrement à leur <strong>rapport</strong> <span class="math inline">\(P(H_0|E)/P(H_1|E)\)</span> nommé le <strong>facteur de Bayes</strong></li>
<li class="fragment">Il ne cherche donc pas à nullifier une hypothèse</li>
<li class="fragment">Les deux hypothèses ne doivent pas nécessairement être complémentaires</li>
</ul>
</div>
</div></div>
</section>
<section id="contexte-8" class="slide level2">
<h2>Contexte</h2>
<h3 id="conclusion">Conclusion</h3>
<p><strong>L’approche fréquentiste se focalise sur la fiabilité des procédures qui engendrent les résultats :</strong></p>
<div>
<ul>
<li class="fragment">erreur de type I : on accepte de valider <span class="math inline">\(H_1\)</span> à tort dans 5% des cas</li>
<li class="fragment">erreur de type II : on accepte de rejeter <span class="math inline">\(H_1\)</span> à tort dans 20% des cas</li>
<li class="fragment">intervalle de confiance : on accepte que la <strong>vraie</strong> valeur du paramètre ne soit pas dans l’intervalle de confiance dans 5% des cas</li>
</ul>
</div>
</section>
<section id="contexte-9" class="slide level2">
<h2>Contexte</h2>
<h3 id="conclusion-1">Conclusion</h3>
<p><strong>L’approche fréquentiste se focalise sur la fiabilité des procédures qui engendrent les résultats :</strong></p>
<ul>
<li>erreur de type I : on accepte de valider <span class="math inline">\(H_1\)</span> à tort dans 5% des cas</li>
<li>erreur de type II : on accepte de rejeter <span class="math inline">\(H_1\)</span> à tort dans 20% des cas</li>
<li>intervalle de confiance : on accepte que la <strong>vraie valeur</strong> du paramètre ne soit pas dans l’intervalle de confiance dans 5% des cas</li>
</ul>
<p><strong>L’approche bayésienne se focalise sur la crédibilité des hypothèses au regard des observations <span class="math inline">\(P(H|E)\)</span></strong></p>
</section>
<section id="contexte-10" class="slide level2">
<h2>Contexte</h2>
<h3 id="conclusion-2">Conclusion</h3>
<p><strong>L’approche fréquentiste se focalise sur la fiabilité des procédures qui engendrent les résultats :</strong></p>
<ul>
<li>erreur de type I : on accepte de valider <span class="math inline">\(H_1\)</span> à tort dans 5% des cas</li>
<li>erreur de type II : on accepte de rejeter <span class="math inline">\(H_1\)</span> à tort dans 20% des cas</li>
<li>intervalle de confiance : on accepte que la <strong>vraie valeur</strong> du paramètre ne soit pas dans l’intervalle de confiance dans 5% des cas</li>
</ul>
<p><strong>L’approche bayésienne se focalise sur la crédibilité des hypothèses au regard des observations <span class="math inline">\(P(H|E)\)</span></strong></p>
<p><font color="red"><b>Alors pourquoi cette approche n’est pas l’approche dominante ?</b></font></p>
<p>Pour répondre il faut d’abord comprendre les grands principes de l’inférence bayésienne…</p>
</section>
<section id="plan-du-cours-1" class="slide level2">
<h2>Plan du cours</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Contexte</li>
<li><strong>L’inférence bayésienne</strong></li>
<li>Cas pratiques</li>
<li>Pour aller plus loin</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Grands principes</li>
<li>Théorème de Bayes</li>
<li>Les priors</li>
<li>La distribution postérieure</li>
<li>Un exemple</li>
</ul>
</div></div>
</section>
<section id="linférence-bayésienne" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="grands-principes">Grands principes</h3>
<blockquote>
<p>L’hypothèse de base de l’inférence bayésienne est que la <strong>probabilité</strong> doit-être interprétée comme un degré de <strong>croyance rationnelle</strong>.</p>
</blockquote>
</section>
<section id="linférence-bayésienne-1" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="grands-principes-1">Grands principes</h3>
<blockquote>
<p>L’hypothèse de base de l’inférence bayésienne est que la <strong>probabilité</strong> doit-être interprétée comme un degré de <strong>croyance rationnelle</strong>.</p>
</blockquote>
<div>
<p>L’inférence bayésienne est associée aux trois principes suivants :</p>
<ul>
<li class="fragment">Les degrés de croyance sont représentés par des probabilités</li>
<li class="fragment">La révision des degrés de croyance est régie par l’utilisation le théorème de Bayes</li>
<li class="fragment">L’évaluation des hypothèses et les prises de décision reposent uniquement sur la distribution a posteriori <span class="math inline">\(P(H|E)\)</span> où <span class="math inline">\(E\)</span> représente les observations et <span class="math inline">\(H\)</span> les hypothèses</li>
</ul>
</div>
</section>
<section id="linférence-bayésienne-2" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="théorème-de-bayes">Théorème de Bayes</h3>
<p>Considérons des hypothèses <span class="math inline">\(H\)</span> et des observations (evidence) <span class="math inline">\(E\)</span>. <br></p>
<p><font color="darkgreen">Par exemple :</font></p><font color="darkgreen">
</font><ul><font color="darkgreen">
<li><span class="math inline">\(H\)</span> : la pièce lancée est équilibrée</li>
</font><li><font color="darkgreen"><span class="math inline">\(E\)</span> : la pièce est tombée 5 fois sur pile</font></li>
</ul>
<h4 id="ce-qui-nous-intéresse-cest-la-distribution-de-probabilité-conjointe-davoir-ces-évènements-et-cette-hypothèse">Ce qui nous intéresse c’est la distribution de probabilité conjointe d’avoir ces évènements et cette hypothèse :</h4>
<p><span class="math display">\[P(H,E)\]</span></p>
</section>
<section id="linférence-bayésienne-3" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="théorème-de-bayes-1">Théorème de Bayes</h3>
<p>Considérons des hypothèses <span class="math inline">\(H\)</span> et des observations (evidences) <span class="math inline">\(E\)</span>. <br> Ce qui nous intéresse c’est la distribution de probabilité conjointe d’avoir ces évènements et ces hypothèses :</p>
<p><span class="math display">\[P(H,E)\]</span></p>
<h4 id="on-peut-décomposer-cette-distribution-conjointe-en-utilisant-les-probabilités-conditionnelles.-deux-manières-possibles">On peut décomposer cette distribution conjointe en utilisant les probabilités conditionnelles. Deux manières possibles :</h4>
<ul>
<li>En passant par la probabilité des hypothèses sachant les observations : <span class="math display">\[P(H,E) = P(H|E)P(E)\]</span></li>
</ul>
<p><font color="darkgreen">Autrement dit la probabilité que la pièce soit équilibrée sachant qu’elle a été lancée 5 fois sur pile, multipliée par la probabilité d’avoir 5 fois pile (dans l’absolue)</font></p>
</section>
<section id="linférence-bayésienne-4" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="théorème-de-bayes-2">Théorème de Bayes</h3>
<p>Considérons des hypothèses <span class="math inline">\(H\)</span> et des observations (evidences) <span class="math inline">\(E\)</span>. <br> Ce qui nous intéresse c’est la distribution de probabilité conjointe d’avoir ces évènements et ces hypothèses :</p>
<p><span class="math display">\[P(H,E)\]</span></p>
<h4 id="on-peut-décomposer-cette-distribution-conjointe-en-utilisant-les-probabilités-conditionnelles.-deux-manières-possibles-1">On peut décomposer cette distribution conjointe en utilisant les probabilités conditionnelles. Deux manières possibles :</h4>
<ul>
<li><p>En passant par la probabilité des hypothèses sachant les observations : <span class="math display">\[P(H,E) = P(H|E)P(E)\]</span></p></li>
<li><p>En passant par la probabilité des observations sachant les hypothèses : <span class="math display">\[P(H,E) = P(E|H)P(H)\]</span></p></li>
</ul>
<p><font color="darkgreen">Cette fois en considérant la probabilité d’avoir lancé 5 fois sur pile sachant que la pièce est équilibrée, multipliée par la probabilité que la pièce soit équilibrée</font></p>
</section>
<section id="linférence-bayésienne-5" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="théorème-de-bayes-3">Théorème de Bayes</h3>
<p>Considérons une hypothèse <span class="math inline">\(H\)</span> et des observations (evidence) <span class="math inline">\(E\)</span>. <br></p>
<h4 id="en-combinant-les-deux-égalités-précédentes-on-obtient-le-théorème-de-bayes">En combinant les deux égalités précédentes, on obtient le théorème de Bayes :</h4>
<p><span class="math display">\[P(H|E) = P(H) \frac{P(E|H)}{P(E)}\]</span></p>
<p><font color="darkgreen">Ce théorème permet de passer de <strong>la connaissance de l’hypothèse avant d’avoir vu les observations</strong> <span class="math inline">\(P(H)\)</span> à la <strong>probabilité a posteriori</strong> des hypothèses, une fois les observations prise en compte <span class="math inline">\(P(H|E)\)</span></font></p>
</section>
<section id="linférence-bayésienne-6" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="théorème-de-bayes-4">Théorème de Bayes</h3>
<p>Considérons une hypothèse <span class="math inline">\(H\)</span> et des observations (evidence) <span class="math inline">\(E\)</span>. <br> En combinant les deux égalités précédentes, on obtient le théorème de Bayes :</p>
<p><span class="math display">\[P(H|E) = P(H) \frac{P(E|H)}{P(E)}\]</span></p>
<h4 id="mais-cette-démarche-met-en-évidence-deux-difficultés">Mais cette démarche met en évidence deux difficultés :</h4>
<div>
<ul>
<li class="fragment">La connaissance a priori de la probabilité des hypothèses <span class="math inline">\(P(H)\)</span></li>
<li class="fragment">Le calcul de la probabilité des observations <span class="math inline">\(P(E)\)</span> ( la constante de normalisation)</li>
</ul>
</div>
</section>
<section id="linférence-bayésienne-7" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors">Les priors</h3>
<p><em>Au début du XX ème siècle, l’idéal dominant est que la science doit aspirer à la certitude et fournir une vision objective et impartiale de la réalit.</em> <br></p>
<blockquote>
<p>La notion de prior “forcément” subjectif conduira au rejet de l’approche bayésienne</p>
</blockquote>
<h4 id="il-existe-aujourdhui-trois-propositions-de-piors"><strong>Il existe aujourd’hui trois propositions de piors</strong></h4>
</section>
<section id="linférence-bayésienne-8" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors-1">Les priors</h3>
<h4 id="les-priors-conjugués-solution-analytique">Les priors conjugués (solution analytique)</h4>
Ces priors permettent de calculer analytiquement la distribution postérieure.
<center>
<img data-src="./images/discrete_conjugate_distribution.png" style="width:90.0%">
</center>
</section>
<section id="linférence-bayésienne-9" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors-2">Les priors</h3>
<h4 id="les-priors-non-informatifs">Les priors non informatifs :</h4>
<p>Un prior non informatif est une distribution de probabilité qui a pour but d’avoir une influence minimale sur les résultats de l’analyse.</p>
<div>
<ul>
<li class="fragment">Cela permet aux données observées de jouer un rôle plus déterminant dans la formation des conclusions.</li>
<li class="fragment">Utilisés pour caractériser une absence d’information préalable.</li>
<li class="fragment">Un exemple est un prior uniforme sur un intervalle de valeurs.</li>
</ul>
</div>
</section>
<section id="linférence-bayésienne-10" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors-3">Les priors</h3>
<h4 id="les-priors-non-informatifs-1">Les priors non informatifs :</h4>
<p>Un prior non informatif est une distribution de probabilité qui a pour but d’avoir une influence minimale sur les résultats de l’analyse.</p>
<ul>
<li>Cela permet aux données observées de jouer un rôle plus déterminant dans la formation des conclusions.</li>
<li>Utilisés pour caractériser une absence d’information préalable.</li>
<li>Un exemple est un prior uniforme sur un intervalle de valeurs.</li>
</ul>
<h4 id="cette-notion-de-prior-non-informatif-est-souvent-attribuée-à-harold-jeffreys.">Cette notion de prior non informatif est souvent attribuée à Harold Jeffreys.</h4>
</section>
<section id="linférence-bayésienne-11" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors-4">Les priors</h3>
<h4 id="les-priors-faiblement-informatifs">Les priors faiblement informatifs</h4>
<p>Un prior faiblement informatif est une distribution de probabilité qui a pour but d’avoir une influence minimale sur les résultats, tout en facilitant les calculs de la distribution postérieure.</p>
<div>
<ul>
<li class="fragment">Un exemple : on considère un modèle de régression linéaire avec deux priors, un pour le paramètre lié à la moyenne et un pour la variance. Un prior faiblement informatif sera une distribution de probabilité sur les valeurs positives, comme une distribution exponentielle ou half-Normale.</li>
</ul>
</div>
</section>
<section id="linférence-bayésienne-12" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="les-priors-5">Les priors</h3>
<h4 id="les-priors-faiblement-informatifs-1">Les priors faiblement informatifs</h4>
<p>Un prior faiblement informatif est une distribution de probabilité qui a pour but d’avoir une influence minimale sur les résultats, tout en facilitant les calculs de la distribution postérieure.</p>
<ul>
<li>Un exemple : on considère un modèle de régression linéaire avec deux priors, un pour le paramètre lié à la moyenne et un pour la variance. Un prior faiblement informatif sera une distribution de probabilité sur les valeurs positives, comme une distribution exponentielle ou half-Normale.</li>
</ul>
<h4 id="cette-notion-de-prior-faiblement-informatif-a-été-popularisé-par-andrew-gelman.">Cette notion de prior faiblement informatif a été popularisé par Andrew Gelman.</h4>
<p>Il est également à la base du logiciel STAN qui est un des premiers outils de modélisation bayésienne.</p>
</section>
<section id="linférence-bayésienne-13" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="la-distribution-postérieure">La distribution postérieure</h3>
<p>On a vu que le prise de décision doit repose sur la seule distribution postérieure. <br> <font color="orange">Problème : Dans la majeure partie des cas, la distribution postérieure n’est pas calculable analytiquement.</font></p>
<p><font color="darkgreen">L’évolution des capacités de calculs a permis de développer des méthodes d’inférence bayésienne qui permettent de calculer la distribution postérieure de manière approchée.</font></p>
<p>Voici deux méthodes d’inférence bayésienne</p>
</section>
<section id="linférence-bayésienne-14" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="la-distribution-postérieure-1">La distribution postérieure</h3>
<h4 id="stochastic-variational-inference">Stochastic Variational Inference <sup>1</sup></h4>
<p><font color="darkgreen" size="4"><b>Cette méthode est rapide et précise. <br> Cependant, sa précision peu se dégrader en fonction des choix de famille de distribution et de la dimension du problème.</b></font> <img data-src="./images/Stochastic%20Variational%20Inference.PNG"></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>https://pyro.ai/examples/svi_part_i.html</p></li></ol></aside></section>
<section id="linférence-bayésienne-15" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="la-distribution-postérieure-2">La distribution postérieure</h3>
<h4 id="markov-chain-monte-carlo">Markov Chain Monte Carlo</h4>
<p><font color="darkgreen" size="4"><b>Cette méthode est la plus robuste. <br> Cependant, elle peut devenir lente avec l’augmentation des dimensions.</b></font> <img data-src="./images/H-mcmc.gif" style="width:70.0%"></p>
</section>
<section id="linférence-bayésienne-16" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="la-distribution-postérieure-3">La distribution postérieure</h3>
<h4 id="exemple-hamiltonian-monte-carlo">exemple : Hamiltonian Monte Carlo</h4>
<p><font color="darkgreen" size="4"><b>Cette méthode a beaucoup évoluée et est adaptée à toute sorte de distribution sur les paramètres.</b></font> <img data-src="./images/hmc.gif" style="width:70.0%"></p>
</section>
<section id="linférence-bayésienne-17" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="bilan-de-la-démarche">Bilan de la démarche</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><strong>Poser la question d’intérêt clairement</strong></li>
</ul>
</div><div class="column" style="width:50%;">
<div>
<p><font color="orange"><strong>Formuler les hypothèses et en déduire</strong></font></p>
<ul>
<li class="fragment">les variables prédictrices (variables indépendantes)</li>
<li class="fragment">les variables prédites (variables dépendantes)</li>
<li class="fragment">les variables non mesurées (mais influentes)</li>
</ul>
</div>
</div></div>
</section>
<section id="linférence-bayésienne-18" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="bilan-de-la-démarche-1">Bilan de la démarche</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Poser la question d’intérêt clairement</li>
<li><strong>Définir le modèle génératif</strong></li>
</ul>
</div><div class="column" style="width:50%;">
<div>
<p><font color="orange"><strong>Comment sont générées les données</strong></font></p>
<ul>
<li class="fragment">La VD évolue avec les VIs <span class="math inline">\(\to\)</span> modèle linéaire</li>
<li class="fragment">La VD est binaire <span class="math inline">\(\to\)</span> modèle logistique</li>
<li class="fragment">La VD est un temps d’attente <span class="math inline">\(\to\)</span> modèle de poisson</li>
<li class="fragment">…</li>
</ul>
</div>
</div></div>
</section>
<section id="linférence-bayésienne-19" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="bilan-de-la-démarche-2">Bilan de la démarche</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Poser la question d’intérêt clairement</li>
<li>Définir le modèle génératif</li>
<li><strong>Implémenter le modèle et calculer la postérieure</strong></li>
</ul>
</div><div class="column" style="width:50%;">
<div>
<p><font color="orange"><strong>Implémentation</strong></font></p>
<ul>
<li class="fragment">Construire le modèle</li>
<li class="fragment">Définir les priors</li>
<li class="fragment">Faire tourner l’inférence</li>
<li class="fragment">Vérifier l’algorithme</li>
</ul>
</div>
</div></div>
</section>
<section id="linférence-bayésienne-20" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="bilan-de-la-démarche-3">Bilan de la démarche</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Poser la question d’intérêt clairement</li>
<li>Définir le modèle génératif</li>
<li>Implémenter le modèle et calculer la postérieure</li>
<li><strong>Confronter le résultat à la réalité</strong></li>
</ul>
</div><div class="column" style="width:50%;">
<div>
<p><font color="orange"><strong>Vérification et consolidation</strong></font></p>
<ul>
<li class="fragment">Visualiser les résultats</li>
<li class="fragment">Boucler en modifiant le modèle jusqu’à obtenir un résultat satisfaisant</li>
</ul>
</div>
</div></div>
</section>
<section id="linférence-bayésienne-21" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="un-exemple-le-problème-de-monty-hall">Un exemple : Le problème de Monty Hall</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./images/monty1.png"></p>
<p><font color="ORANGE" size="5"><b>Le joueur a-t-il intérêt à changer de porte ?</b></font></p>
</div><div class="column" style="width:50%;">
<p><br><br></p>
<ul>
<li>Formuler le problème de manière “bayésienne”</li>
<li>Définir la distribution a priori</li>
<li>Définir la fonction de vraisemblance</li>
<li>Appliquer le théorème Bayes</li>
<li>Le résultat était-il intuitif ?</li>
</ul>
</div></div>
</section>
<section id="linférence-bayésienne-22" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="un-exemple-le-problème-de-monty-hall-1">Un exemple : Le problème de Monty Hall</h3>
<h4 id="posons-le-problème-de-manière-bayésienne">Posons le problème de manière bayésienne :</h4>
<ol type="1">
<li>L’espace des probabilité est conditionné par le fait que le joueur a choisi la porte A</li>
<li>L’hypothèse <span class="math inline">\(H\)</span> que l’on considère est : La voiture se trouve dernière la porte A, B ou C</li>
<li>La donnée <span class="math inline">\(E\)</span> est : l’animateur a ouvert la porte C</li>
</ol>
<p>Question : Quelle est la distribution a posteriori (que la voiture soit derrière une des deux porte restante) ?</p>
<p><span class="math display">\[P(H|D) ?\]</span></p>
</section>
<section id="linférence-bayésienne-23" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="un-exemple-le-problème-de-monty-hall-2">Un exemple : Le problème de Monty Hall</h3>
<h4 id="définissons-la-distribution-a-priori">Définissons la distribution a priori :</h4>
<p><span class="math display">\[P(H~|~E) = \frac{P(E~|~H)~P(H)}{P(E)}\]</span></p>
<ul>
<li><strong>Calcul du prior</strong> <span class="math inline">\(P(H)\)</span> : <br> Probabilité que la voiture soit derrière les portes A, B ou C. <br> -&gt; On n’a pas d’information particulière donc on choisit un prior non informatif (distribution uniforme).</li>
</ul>
<table class="caption-top" style="width:92%;">
<caption>Monty Hall.</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 29%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>H</th>
<th><span class="math inline">\(P(H)\)</span></th>
<th><pre><code> $P(E|H)$</code></pre></th>
<th><pre><code>$P(H|E)$</code></pre></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>porte A</td>
<td>1/3</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>porte B</td>
<td>1/3</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>porte C</td>
<td>1/3</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="linférence-bayésienne-24" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="un-exemple-le-problème-de-monty-hall-3">Un exemple : Le problème de Monty Hall</h3>
<h4 id="posons-le-problème-de-manière-bayésienne-1">Posons le problème de manière bayésienne :</h4>
<p><span class="math display">\[P(H~|~E) = \frac{P(E~|~H)~P(H)}{P(E)}\]</span></p>
<ul>
<li><strong>Calcul de la vraisemblance</strong> <span class="math inline">\(P(E~|~H)\)</span> :<br> Probabilité que l’animateur ouvre la porte C sachant que le joueur a choisi la porte A et que la voiture se trouve derrière la porte H.</li>
</ul>
<table class="caption-top" style="width:92%;">
<caption>Monty Hall.</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 29%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>H</th>
<th><span class="math inline">\(P(H)\)</span></th>
<th><pre><code> $P(E|H)$</code></pre></th>
<th><pre><code>$P(H|E)$</code></pre></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>porte A</td>
<td>1/3</td>
<td><pre><code>   1/2</code></pre></td>
<td></td>
</tr>
<tr class="even">
<td>porte B</td>
<td>1/3</td>
<td><pre><code>     1</code></pre></td>
<td></td>
</tr>
<tr class="odd">
<td>porte C</td>
<td>1/3</td>
<td><pre><code>     0</code></pre></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="linférence-bayésienne-25" class="slide level2">
<h2>L’inférence bayésienne</h2>
<h3 id="un-exemple-le-problème-de-monty-hall-4">Un exemple : Le problème de Monty Hall</h3>
<h4 id="posons-le-problème-de-manière-bayésienne-2">Posons le problème de manière bayésienne :</h4>
<p><span class="math display">\[P(H~|~E) = \frac{P(E~|~H)~P(H)}{P(E)}\]</span></p>
<ul>
<li><span class="math inline">\(P(H|E)\)</span> : Probabilité postérieure de chaque porte sachant que l’animateur ouvre la porte C sachant que le joueur a choisi la porte A.</li>
</ul>
<table class="caption-top" style="width:88%;">
<caption>Monty Hall.</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 29%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>H</th>
<th><span class="math inline">\(P(H)\)</span></th>
<th><pre><code> $P(E|H)$</code></pre></th>
<th><pre><code>$P(H|E)$</code></pre></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>porte A</td>
<td>1/3</td>
<td><pre><code> 1/2</code></pre></td>
<td><pre><code> 1/3</code></pre></td>
</tr>
<tr class="even">
<td>porte B</td>
<td>1/3</td>
<td><pre><code>  1</code></pre></td>
<td><pre><code> 2/3</code></pre></td>
</tr>
<tr class="odd">
<td>porte C</td>
<td>1/3</td>
<td><pre><code>  0</code></pre></td>
<td><pre><code>   0</code></pre></td>
</tr>
</tbody>
</table>
</section>
<section id="plan-du-cours-2" class="slide level2">
<h2>Plan du cours</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Contexte</li>
<li>L’inférence bayésienne</li>
<li><strong>Cas pratiques</strong></li>
<li>Pour aller plus loin</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>EDA</li>
<li>Estimation de paramètres</li>
<li>Test d’hypothèse</li>
<li>Comparaison de modèles</li>
</ul>
</div></div>
</section>
<section id="cas-pratiques" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="exploratory-data-analysis">Exploratory data analysis</h3>
<h4 id="les-données">Les données</h4>
<div class="columns">
<div class="column" style="width:50%;">
<p>Chargement du jeu de données <sup>1</sup></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="co">#| echo: false</span></span>
<span id="cb16-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-3"><a href=""></a>df_howell1 <span class="op">=</span> pd.read_csv(<span class="st">"./Data/Howell1.csv"</span>, sep<span class="op">=</span><span class="st">";"</span>)</span>
<span id="cb16-4"><a href=""></a>df_howell1.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<div id="db638184" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>151.765</td>
<td>47.825606</td>
<td>63.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>139.700</td>
<td>36.485807</td>
<td>63.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>136.525</td>
<td>31.864838</td>
<td>65.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>156.845</td>
<td>53.041914</td>
<td>41.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>145.415</td>
<td>41.276872</td>
<td>51.0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>https://xcelab.net/rm/statistical-rethinking/</p></li></ol></aside></section>
<section id="cas-pratiques-1" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="exploratory-data-analysis-1">Exploratory data analysis</h3>
<h4 id="les-données-1">Les données</h4>
<div id="0918c6ec" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-2"><a href=""></a>sns.pairplot(data<span class="op">=</span> df_howell1, hue<span class="op">=</span><span class="st">"male"</span>, height<span class="op">=</span><span class="fl">1.5</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-4-output-1.png" width="702" height="427"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-2" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres">Estimation de paramètres</h3>
<h4 id="premier-problème">Premier problème</h4>
<p>Question : Peut-on prédire le poids à partir de la taille après 18 ans ?</p>
<div>
<ul>
<li class="fragment"><p>Préparation des données :</p>
<div class="sourceCode" id="cb18" data-code-line-numbers="|2|4-5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="co"># select observation based on age &gt;= 18</span></span>
<span id="cb18-2"><a href=""></a>data_sup18 <span class="op">=</span> df_howell1[df_howell1.age<span class="op">&gt;=</span><span class="dv">18</span>].copy()</span>
<span id="cb18-3"><a href=""></a><span class="co"># Center height -&gt; intercept = weight at mean height</span></span>
<span id="cb18-4"><a href=""></a>center <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">-</span> x.mean() </span>
<span id="cb18-5"><a href=""></a>data_sup18[<span class="st">"height_c"</span>] <span class="op">=</span>  center(data_sup18.height)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li class="fragment"><p>Pour Numpyro</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a><span class="co"># create dict for inference with numpyro</span></span>
<span id="cb19-2"><a href=""></a>dat1 <span class="op">=</span> {</span>
<span id="cb19-3"><a href=""></a>    <span class="st">"height"</span> : data_sup18.height_c.values,</span>
<span id="cb19-4"><a href=""></a>    <span class="st">"weight"</span> : data_sup18.weight.values</span>
<span id="cb19-5"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</div>
</section>
<section id="cas-pratiques-3" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-1">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<div class="columns">
<div class="column" style="width:50%;">
<br> <font color="orange">
<center>
Définition du modèle
</center>
</font><p><font color="orange"></font></p>
<p><span class="math display">\[
\begin{align}
W_i \sim Normal(\mu_i, \sigma)  \\
mu_i = \alpha + \beta H_i       \\
\alpha \sim Normal(0, 1)        \\
\beta \sim HalfNormal(1)        \\
\sigma \sim HalfNormal(1)       \\
\end{align}
\]</span></p>
</div><div class="column" style="width:50%;">
<font color="orange">
<center>
Les paramètres
</center>
</font><p><font color="orange"></font></p>
<ul>
<li><span class="math inline">\(\alpha\)</span> : c’est l’intercept et dans notre cas le poids correspondant à la taille moyenne de l’échantillon.</li>
<li><span class="math inline">\(\beta\)</span> : c’est la pente et dans notre cas l’augmentation de poids correspondant à une augmentation de taille de 1 cm.</li>
<li><span class="math inline">\(\sigma\)</span> : c’est l’écart-type du modèle.</li>
</ul>
</div></div>
</section>
<section id="cas-pratiques-4" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-2">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans-1">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<p>Implémentation du modèle</p>
<div class="sourceCode" id="cb20" data-code-line-numbers="|2|4-6|8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href=""></a><span class="co"># Define the model</span></span>
<span id="cb20-2"><a href=""></a><span class="kw">def</span> mdl1(height, weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb20-3"><a href=""></a>    <span class="co"># Define prior</span></span>
<span id="cb20-4"><a href=""></a>    a <span class="op">=</span> numpyro.sample(<span class="st">'a'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb20-5"><a href=""></a>    b <span class="op">=</span> numpyro.sample(<span class="st">'b'</span>, dist.HalfNormal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb20-6"><a href=""></a>    s <span class="op">=</span> numpyro.sample(<span class="st">'s'</span>, dist.HalfNormal(<span class="dv">1</span>))</span>
<span id="cb20-7"><a href=""></a>    <span class="co"># Define likelihood</span></span>
<span id="cb20-8"><a href=""></a>    numpyro.sample(<span class="st">"obs"</span>, dist.Normal(a<span class="op">+</span>b<span class="op">*</span>height, s), obs<span class="op">=</span>weight)</span>
<span id="cb20-9"><a href=""></a><span class="co"># plot model</span></span>
<span id="cb20-10"><a href=""></a>numpyro.render_model(mdl1, model_args<span class="op">=</span>dat1.values(), render_distributions<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<img data-src="cours_2024_files/figure-revealjs/cell-6-output-1.svg" class="r-stretch"></section>
<section id="cas-pratiques-5" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-3">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans-2">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<ul>
<li>Calcul des résultats</li>
</ul>
<div id="ae32cde2" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a>mcmc1 <span class="op">=</span> MCMC(NUTS(mdl1), num_warmup<span class="op">=</span><span class="dv">500</span>, num_samples<span class="op">=</span><span class="dv">1000</span>, num_chains<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb21-2"><a href=""></a>mcmc1.run(random.PRNGKey(<span class="dv">42</span>), <span class="op">**</span>dat1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cas-pratiques-6" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-4">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans-3">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<ul>
<li>Vérification de la convergence de l’algorithme</li>
</ul>
<div id="ce9b79d7" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-8-output-1.png" width="758" height="373"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-7" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-5">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans-4">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<ul>
<li>Visualisation des résultats</li>
</ul>
<div id="f31b78c4" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a>az.plot_posterior(idata1, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">3</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-9-output-1.png" width="763" height="292"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-8" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="estimation-de-paramètres-6">Estimation de paramètres</h3>
<h4 id="peut-on-prédire-le-poids-à-partir-de-la-taille-après-18-ans-5">Peut-on prédire le poids à partir de la taille après 18 ans ?</h4>
<ul>
<li>Conclusion</li>
</ul>
<div id="5ebc1b7c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a>mcmc1.print_summary(<span class="fl">0.89</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.5%     94.5%     n_eff     r_hat
         a     41.92      0.43     41.95     41.23     42.57    893.65      1.00
         b      0.63      0.03      0.63      0.57      0.69   1176.63      1.00
         s      5.08      0.29      5.06      4.65      5.56    824.26      1.00

Number of divergences: 0</code></pre>
</div>
</div>
<ul>
<li>On peut dire :
<ul>
<li>Pour la taille moyenne, le poids est de 41.89kg et à 89% dans [41.25, 42.59]</li>
<li>Pour chaque centimètre supplémentaire, le poids augmente de 630g</li>
</ul></li>
</ul>
</section>
<section id="cas-pratiques-9" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse">Test d’hypothèse</h3>
<h4 id="deuxième-problème">Deuxième problème</h4>
<p>Question : Quelle est la différence de poids entre les hommes et les femmes après 18 ans ?</p>
<div id="45d561b4" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-11-output-1.png" width="659" height="356"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-10" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-1">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans">Différence de poids hommes/femmes après 18 ans ?</h4>
<div class="columns">
<div class="column" style="width:50%;">
<br> <font color="orange">
<center>
Définition du modèle
</center>
</font><p><font color="orange"></font></p>
<p><span class="math display">\[
\begin{align}
W_i \sim Normal(\mu_i, \sigma)  \\
\mu_i = \alpha[male]            \\
\alpha \sim HalfNormal(0, 10)   \\
\sigma \sim HalfNormal(1)       \\
\end{align}
\]</span></p>
</div><div class="column" style="width:50%;">
<font color="orange">
<center>
Les paramètres
</center>
</font><p><font color="orange"></font></p>
<ul>
<li><span class="math inline">\(\alpha\)</span> : c’est l’intercept mais il prend deux valeur, une pour les hommes et une pour les femmes. A noter que la distribution est une HalfNormal car les valeurs doivent être positives.</li>
<li><span class="math inline">\(\sigma\)</span> : c’est l’écart-type du modèle.</li>
</ul>
</div></div>
</section>
<section id="cas-pratiques-11" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-2">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-1">Différence de poids hommes/femmes après 18 ans ?</h4>
<p>Implémentation du modèle</p>
<div class="sourceCode" id="cb25" data-code-line-numbers="|2-5|7|9-10|12|14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href=""></a><span class="co"># create dict for inference with numpyro</span></span>
<span id="cb25-2"><a href=""></a>dat2 <span class="op">=</span> {</span>
<span id="cb25-3"><a href=""></a>    <span class="st">"male"</span> : data_sup18.male.values,</span>
<span id="cb25-4"><a href=""></a>    <span class="st">"weight"</span> : data_sup18.weight.values</span>
<span id="cb25-5"><a href=""></a>}</span>
<span id="cb25-6"><a href=""></a><span class="co"># Define the model</span></span>
<span id="cb25-7"><a href=""></a><span class="kw">def</span> mdl2(male, weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb25-8"><a href=""></a>    <span class="co"># Define prior</span></span>
<span id="cb25-9"><a href=""></a>    <span class="cf">with</span> numpyro.plate(<span class="st">"male"</span>, <span class="dv">2</span>):</span>
<span id="cb25-10"><a href=""></a>        a <span class="op">=</span> numpyro.sample(<span class="st">'a'</span>, dist.HalfNormal(<span class="dv">10</span>))</span>
<span id="cb25-11"><a href=""></a>    s <span class="op">=</span> numpyro.sample(<span class="st">'s'</span>, dist.HalfNormal(<span class="dv">1</span>))</span>
<span id="cb25-12"><a href=""></a>    diff_a <span class="op">=</span> numpyro.deterministic(<span class="st">"diff_a"</span>, a[<span class="dv">1</span>]<span class="op">-</span> a[<span class="dv">0</span>])</span>
<span id="cb25-13"><a href=""></a>    <span class="co"># Define likelihood</span></span>
<span id="cb25-14"><a href=""></a>    numpyro.sample(<span class="st">"obs"</span>, dist.Normal(a[male], s), obs<span class="op">=</span>weight)</span>
<span id="cb25-15"><a href=""></a><span class="co"># plot model</span></span>
<span id="cb25-16"><a href=""></a>numpyro.render_model(mdl2, model_args<span class="op">=</span>dat2.values(), render_distributions<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cas-pratiques-12" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-3">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-2">Différence de poids hommes/femmes après 18 ans ?</h4>
<p>Graph du modèle</p>

<img data-src="cours_2024_files/figure-revealjs/cell-12-output-1.svg" class="r-stretch"></section>
<section id="cas-pratiques-13" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-4">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-3">Différence de poids hommes/femmes après 18 ans ?</h4>
<ul>
<li>Calcul des résultats</li>
</ul>
<div id="468ff82e" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href=""></a>mcmc2 <span class="op">=</span> MCMC(NUTS(mdl2), num_warmup<span class="op">=</span><span class="dv">500</span>, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb26-2"><a href=""></a>mcmc2.run(random.PRNGKey(<span class="dv">42</span>), <span class="op">**</span>dat2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cas-pratiques-14" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-5">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-4">Différence de poids hommes/femmes après 18 ans ?</h4>
<ul>
<li>Vérification de la convergence de l’algorithme</li>
</ul>
<div id="f67ec610" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-14-output-1.png" width="758" height="373"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-15" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-6">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-5">Différence de poids hommes/femmes après 18 ans ?</h4>
<ul>
<li>Visualisation des résultats</li>
</ul>
<div id="ed41cba5" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href=""></a>az.plot_posterior(idata2, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">3</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-15-output-1.png" width="767" height="313"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-16" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="test-dhypothèse-7">Test d’hypothèse</h3>
<h4 id="différence-de-poids-hommesfemmes-après-18-ans-6">Différence de poids hommes/femmes après 18 ans ?</h4>
<ul>
<li>Conclusion</li>
</ul>
<div id="3e4e60be" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a>az.summary(idata2, hdi_prob<span class="op">=</span><span class="fl">0.89</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_5.5%</th>
<th data-quarto-table-cell-role="th">hdi_94.5%</th>
<th data-quarto-table-cell-role="th">mcse_mean</th>
<th data-quarto-table-cell-role="th">mcse_sd</th>
<th data-quarto-table-cell-role="th">ess_bulk</th>
<th data-quarto-table-cell-role="th">ess_tail</th>
<th data-quarto-table-cell-role="th">r_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a[0]</td>
<td>41.756</td>
<td>0.383</td>
<td>41.161</td>
<td>42.344</td>
<td>0.012</td>
<td>0.008</td>
<td>1083.0</td>
<td>630.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">a[1]</td>
<td>48.503</td>
<td>0.443</td>
<td>47.721</td>
<td>49.133</td>
<td>0.013</td>
<td>0.009</td>
<td>1258.0</td>
<td>583.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">diff_a</td>
<td>6.747</td>
<td>0.620</td>
<td>5.703</td>
<td>7.675</td>
<td>0.018</td>
<td>0.013</td>
<td>1207.0</td>
<td>576.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">s</td>
<td>5.318</td>
<td>0.190</td>
<td>5.041</td>
<td>5.633</td>
<td>0.007</td>
<td>0.005</td>
<td>858.0</td>
<td>686.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>On peut dire que en moyenne la différence de poids entre les hommes et les femmes âgés de plus de 18 ans est de 6.7kg en faveur des homme et se touve à 89% dans [5.7, 7.6].</li>
</ul>
</section>
<section id="cas-pratiques-17" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="comparaison-de-modèles">Comparaison de modèles</h3>
<h4 id="troisième-problème">Troisième problème</h4>
<p>Question : Quelle est le meilleur modèle pour prédire le poids en fonction de la taille ?</p>
<div id="35fbd0a4" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="cours_2024_files/figure-revealjs/cell-17-output-1.png" width="521" height="359"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cas-pratiques-18" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="comparaison-de-modèles-1">Comparaison de modèles</h3>
<h4 id="meilleur-modèle-pour-prédire-le-poids-en-fonction-de-la-taille">Meilleur modèle pour prédire le poids en fonction de la taille ?</h4>
<ul>
<li>Modèle linéaire</li>
</ul>
<div id="a8f56f50" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href=""></a><span class="co"># This time with all the data</span></span>
<span id="cb29-2"><a href=""></a>df_howell1[<span class="st">"height_c"</span>] <span class="op">=</span>  center(df_howell1.height)</span>
<span id="cb29-3"><a href=""></a>dat3 <span class="op">=</span> {</span>
<span id="cb29-4"><a href=""></a>    <span class="st">"height"</span> : df_howell1.height_c.values,</span>
<span id="cb29-5"><a href=""></a>    <span class="st">"weight"</span> : df_howell1.weight.values</span>
<span id="cb29-6"><a href=""></a>}</span>
<span id="cb29-7"><a href=""></a><span class="co"># Define the model</span></span>
<span id="cb29-8"><a href=""></a><span class="kw">def</span> mdl3a(height, weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb29-9"><a href=""></a>    <span class="co"># Define prior</span></span>
<span id="cb29-10"><a href=""></a>    a <span class="op">=</span> numpyro.sample(<span class="st">'a'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb29-11"><a href=""></a>    b <span class="op">=</span> numpyro.sample(<span class="st">'b'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb29-12"><a href=""></a>    s <span class="op">=</span> numpyro.sample(<span class="st">'s'</span>, dist.HalfNormal(<span class="dv">1</span>))</span>
<span id="cb29-13"><a href=""></a>    <span class="co"># Define likelihood</span></span>
<span id="cb29-14"><a href=""></a>    numpyro.sample(<span class="st">"obs"</span>, dist.Normal(a<span class="op">+</span>b<span class="op">*</span>height, s), obs<span class="op">=</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cas-pratiques-19" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="comparaison-de-modèles-2">Comparaison de modèles</h3>
<h4 id="meilleur-modèle-pour-prédire-le-poids-en-fonction-de-la-taille-1">Meilleur modèle pour prédire le poids en fonction de la taille ?</h4>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Modèle quadratic</li>
</ul>
<div id="394c3223" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a><span class="co"># Define the model</span></span>
<span id="cb30-2"><a href=""></a><span class="kw">def</span> mdl3b(height, weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb30-3"><a href=""></a>    <span class="co"># Define prior</span></span>
<span id="cb30-4"><a href=""></a>    a <span class="op">=</span> numpyro.sample(<span class="st">'a'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb30-5"><a href=""></a>    b1 <span class="op">=</span> numpyro.sample(<span class="st">'b1'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb30-6"><a href=""></a>    b2 <span class="op">=</span> numpyro.sample(<span class="st">'b2'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb30-7"><a href=""></a>    s <span class="op">=</span> numpyro.sample(<span class="st">'s'</span>, dist.HalfNormal(<span class="dv">1</span>))</span>
<span id="cb30-8"><a href=""></a>    <span class="co"># Define likelihood</span></span>
<span id="cb30-9"><a href=""></a>    numpyro.sample(<span class="st">"obs"</span>, </span>
<span id="cb30-10"><a href=""></a>        dist.Normal(a<span class="op">+</span>b1<span class="op">*</span>height<span class="op">+</span>b2<span class="op">*</span>height<span class="op">**</span><span class="dv">2</span>, s), </span>
<span id="cb30-11"><a href=""></a>        obs<span class="op">=</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Modèle cubic</li>
</ul>
<div id="445cdf95" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href=""></a><span class="co"># Define the model</span></span>
<span id="cb31-2"><a href=""></a><span class="kw">def</span> mdl3c(height, weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb31-3"><a href=""></a>    <span class="co"># Define prior</span></span>
<span id="cb31-4"><a href=""></a>    a <span class="op">=</span> numpyro.sample(<span class="st">'a'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb31-5"><a href=""></a>    b1 <span class="op">=</span> numpyro.sample(<span class="st">'b1'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb31-6"><a href=""></a>    b2 <span class="op">=</span> numpyro.sample(<span class="st">'b2'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb31-7"><a href=""></a>    b3 <span class="op">=</span> numpyro.sample(<span class="st">'b3'</span>, dist.Normal(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb31-8"><a href=""></a>    s <span class="op">=</span> numpyro.sample(<span class="st">'s'</span>, dist.HalfNormal(<span class="dv">1</span>))</span>
<span id="cb31-9"><a href=""></a>    <span class="co"># Define likelihood</span></span>
<span id="cb31-10"><a href=""></a>    numpyro.sample(<span class="st">"obs"</span>, </span>
<span id="cb31-11"><a href=""></a>        dist.Normal(a<span class="op">+</span>b1<span class="op">*</span>height<span class="op">+</span>b2<span class="op">*</span>height<span class="op">**</span><span class="dv">2</span><span class="op">+</span>b3<span class="op">*</span>height<span class="op">**</span><span class="dv">3</span>, s), </span>
<span id="cb31-12"><a href=""></a>        obs<span class="op">=</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="cas-pratiques-20" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="comparaison-de-modèles-3">Comparaison de modèles</h3>
<h4 id="meilleur-modèle-pour-prédire-le-poids-en-fonction-de-la-taille-2">Meilleur modèle pour prédire le poids en fonction de la taille ?</h4>
<ul>
<li>Résultats modèle 1</li>
</ul>
<div id="8fcd73c3" class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.5%     94.5%     n_eff     r_hat
         a     35.59      0.21     35.59     35.29     35.94    546.94      1.00
         b      0.50      0.01      0.50      0.49      0.52   1096.92      1.00
         s      4.90      0.14      4.91      4.68      5.13    707.60      1.00

Number of divergences: 0</code></pre>
</div>
</div>
<ul>
<li>Résultats modèle 2</li>
</ul>
<div id="cb32a8c1" class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.5%     94.5%     n_eff     r_hat
         a     32.54      0.24     32.54     32.13     32.91    491.65      1.00
        b1      0.64      0.01      0.64      0.63      0.66    361.61      1.00
        b2      0.00      0.00      0.00      0.00      0.00    464.53      1.00
         s      3.90      0.11      3.90      3.72      4.07    438.05      1.00

Number of divergences: 0</code></pre>
</div>
</div>
<ul>
<li>Résultats modèle 3</li>
</ul>
<div id="350b3553" class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.5%     94.5%     n_eff     r_hat
         a      2.07      0.22      2.04      1.72      2.39      2.63      2.35
        b1      0.96      0.04      0.97      0.90      1.02     10.16      1.03
        b2      0.04      0.00      0.04      0.04      0.04     37.28      1.08
        b3      0.00      0.00      0.00      0.00      0.00     22.70      1.06
         s     16.15      0.38     16.15     15.64     16.83    322.70      1.02

Number of divergences: 0</code></pre>
</div>
</div>
</section>
<section id="cas-pratiques-21" class="slide level2">
<h2>Cas pratiques</h2>
<h3 id="comparaison-de-modèles-4">Comparaison de modèles</h3>
<h4 id="meilleur-modèle-pour-prédire-le-poids-en-fonction-de-la-taille-3">Meilleur modèle pour prédire le poids en fonction de la taille ?</h4>
<ul>
<li>Comparaison des trois modèles</li>
</ul>
<div id="d6cd2d91" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rank</th>
<th data-quarto-table-cell-role="th">elpd_waic</th>
<th data-quarto-table-cell-role="th">p_waic</th>
<th data-quarto-table-cell-role="th">elpd_diff</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">se</th>
<th data-quarto-table-cell-role="th">dse</th>
<th data-quarto-table-cell-role="th">warning</th>
<th data-quarto-table-cell-role="th">scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">mdl quardatic</td>
<td>0</td>
<td>-1520.482383</td>
<td>3.661986</td>
<td>0.000000</td>
<td>9.451997e-01</td>
<td>20.961410</td>
<td>0.000000</td>
<td>False</td>
<td>log</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mdl linear</td>
<td>1</td>
<td>-1649.165739</td>
<td>3.452056</td>
<td>128.683357</td>
<td>5.480026e-02</td>
<td>14.919656</td>
<td>16.243557</td>
<td>False</td>
<td>log</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mdl cubic</td>
<td>2</td>
<td>-2416.594966</td>
<td>3.611887</td>
<td>896.112584</td>
<td>8.177216e-09</td>
<td>19.680995</td>
<td>22.601487</td>
<td>True</td>
<td>log</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br></p>
<h4 id="en-pratique-le-meilleur-modèle-est-le-modèle-construit-sur-les-deux-premiers-modèles-linéaire-et-quadratique-proportionnellement-à-leurs-poids-respectifs.">En pratique, le meilleur modèle est le modèle construit sur les deux premiers modèles, linéaire et quadratique, proportionnellement à leurs poids respectifs.</h4>
</section>
<section id="plan-du-cours-3" class="slide level2">
<h2>Plan du cours</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Contexte</li>
<li>L’inférence bayésienne</li>
<li>Cas pratiques</li>
<li><strong>Pour aller plus loin</strong></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Les livres</li>
<li>Les packages par langage</li>
</ul>
</div></div>
</section>
<section id="pour-aller-plus-loin" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-livres">Les livres</h3>
<h4 id="plutôt-pour-les-psychos">Plutôt pour les psychos</h4>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/Doing%20bayesian%20data%20analysis.jpg" width="250"></p>
<figcaption>Livre complet qui décrit l’ensemble des cas auxquels vous serez confrontés. A lire !</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/statistical%20rethinking.jpg" width="250"></p>
<figcaption>Livre excellent accompagné de viséos très claires. Je recommande surtout pour l’analyse causale qui est fondamentale.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-1" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-livres-1">Les livres</h3>
<h4 id="plutôt-pour-python">Plutôt pour python</h4>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/Bayesian%20analysis%20with%20python.jpg" width="250"></p>
<figcaption>Livre facile à comprendre qui met l’accent sur le package pymc. A lire si vous voulez utiliser ce package !</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/Bayesian%20method%20for%20hacker.jpg" width="250"></p>
<figcaption>Livre excellent qui apporte une autre perspective et des graphisme chatoyants ;-).</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-2" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-livres-2">Les livres</h3>
<h4 id="plutôt-théoriques">Plutôt théoriques</h4>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/Bayesian%20Data%20Analysis.jpg" width="250"></p>
<figcaption>Livre théorique support de Stan, le package de référence tous langages confondus. Ardu à lire mais vraiment intéressant</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Books/Machine%20Learning%20A%20Probabilistic%20Perspective.jpg" width="250"></p>
<figcaption>Livre théorique qui étend la cadre probabiliste du psychologue en l’intégrant dans une démarche plus généraliste de machine learning.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-3" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-packages">Les packages</h3>
<h4 id="en-python">En python</h4>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/PyMC_banner.svg" width="250"></p>
<figcaption>C’est le package que je recommande pour commencer. Il est complet et permet de faire toutes les analyses que l’on veut. Il est un peu lent mais peut-être couplé avec jax qui est plus puissant.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/Bambi_logo.png" width="250"></p>
<figcaption>Bambi est un package qui s’utilise conjointement avec Pymc et qui apporte la syntaxe que l’on retrouve dans R.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-4" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-packages-1">Les packages</h3>
<h4 id="en-python-les-mastodontes">En python les mastodontes</h4>
<p>L’intérêt de ces deux packages est qu’ils s’ouvrent sur les réseaux de neurones…</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/numpyro_figure.jpg" width="250"></p>
<figcaption>Pyro et Numpyro sont développés par Uber. Ils sont hyper puissants tout en gardant une certaine simplicité d’utilisation. Numpyro est plus simple et repose sur Jax.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/Tensor%20flow.png" width="250"></p>
<figcaption>TensofFlow Probability est le package développé par Google. Les classes qui décrivent les distributions de probabilités ont été reprises par Pyro et Numpyro. C’est assez complexe !</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-5" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-packages-2">Les packages</h3>
<h4 id="en-r">En R</h4>

<img data-src="./images/Outils/logo.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption">BRMS est le package de référence en R.</p></section>
<section id="pour-aller-plus-loin-6" class="slide level2">
<h2>Pour aller plus loin</h2>
<h3 id="les-packages-3">Les packages</h3>
<h4 id="en-julia">En Julia</h4>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/Julia_Programming_Language_Logo.svg" width="250"></p>
<figcaption>Julia est un “nouveau langage” que je conseille vivement. Il s’apprend comme python ou R mais la syntaxe n’a pas hérité de dizaine d’années de modifications ce qui la rend simple et efficace.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./images/Outils/turing.jpg" width="250"></p>
<figcaption>Pour les curieux, Turing est un package vraiment complet. On peut écrire des modèles comme avec BRMS et la puissance de julia fait le reste… Si vous hésitez alors celui-là mérite tout votre intérêt</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="cours_2024_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="cours_2024_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="cours_2024_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="cours_2024_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>